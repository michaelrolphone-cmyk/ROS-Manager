<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Land Survey Field Tools</title>
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="header-left">
          <button type="button" id="homeButton" class="home-button">
            üè† <span>Home</span>
          </button>
          <h1>Survey Field Tools</h1>
        </div>
        <div class="header-actions">
          <!-- hidden select (internal) -->
          <select id="projectSelect" style="display: none"></select>

          <!-- custom project dropdown -->
          <div id="projectDropdownContainer" class="project-dropdown-container">
            <button
              type="button"
              id="projectDropdownToggle"
              class="project-dropdown-toggle"
            >
              <span class="label" id="projectDropdownLabel">No project</span>
              <span class="arrow">‚ñº</span>
            </button>
            <div id="projectDropdownMenu" class="project-dropdown-menu"></div>
          </div>

          <div id="projectActionsContainer" class="project-actions-container">
            <button
              type="button"
              id="projectActionsToggle"
              class="project-actions-toggle"
            >
              <span>Project Actions</span>
              <span class="arrow">‚ñº</span>
            </button>
            <div id="projectActionsMenu" class="project-actions-menu">
              <button type="button" id="newProjectButton">
                Create Project
              </button>
              <button type="button" class="danger" id="deleteProjectButton">
                Delete Current Project
              </button>
              <button type="button" id="exportCurrentButton">
                Export Current
              </button>
              <button type="button" id="exportAllButton">Export All</button>
              <button type="button" id="importButton">Import</button>
            </div>
          </div>
        </div>
      </div>

      <div class="content">

        <div class="project-controls" id="projectControls">
          <input
            type="text"
            id="projectNameInput"
            placeholder="New Project Name"
          />
          <div style="display: flex; gap: 10px; flex-wrap: wrap">
            <button id="createProjectButton">Create Project</button>
            <button type="button" id="cancelProjectButton">Cancel</button>
          </div>
        </div>

        <div id="springboardSection" class="tool-section springboard active">
          <div id="springboardHero" class="springboard-hero">
            <div class="springboard-hero-header">
              <div>
                <p class="eyebrow">Active Project</p>
                <h1 id="springboardProjectTitle" class="springboard-hero-title">
                  No project selected
                </h1>
                <p
                  id="springboardProjectDescription"
                  class="springboard-hero-subtitle"
                >
                  Create or open a project to see its location context.
                </p>
              </div>
              <span id="springboardStatusChip" class="info-chip"
                >No project</span
              >
            </div>
            <div class="springboard-hero-details">
              <div class="meta-grid">
                <div class="meta-card">
                  <div class="label">Client</div>
                  <span class="value" id="springboardClientValue">‚Äî</span>
                </div>
                <div class="meta-card">
                  <div class="label">Client Phone</div>
                  <div class="value-row">
                    <span class="value" id="springboardClientPhoneValue"
                      >‚Äî</span
                    >
                    <a
                      id="springboardCallButton"
                      class="meta-action"
                      href="#"
                      target="_self"
                      aria-label="Call client"
                      >Call</a
                    >
                  </div>
                </div>
                <div class="meta-card">
                  <div class="label">Address</div>
                  <div class="value-row">
                    <span class="value" id="springboardAddressValue">‚Äî</span>
                    <a
                      id="springboardMapButton"
                      class="meta-action"
                      href="#"
                      target="_blank"
                      rel="noopener"
                      aria-label="Open address in maps"
                      >Map</a
                    >
                  </div>
                </div>
                <div class="meta-card">
                  <div class="label">Client Email</div>
                  <div class="value-row">
                    <span class="value" id="springboardClientEmailValue"
                      >‚Äî</span
                    >
                    <a
                      id="springboardEmailButton"
                      class="meta-action"
                      href="#"
                      target="_self"
                      aria-label="Email client"
                      >Email</a
                    >
                  </div>
                </div>
                <div class="meta-card">
                  <div class="label">Township / Range / Section</div>
                  <span class="value" id="springboardTrsValue">‚Äî</span>
                </div>
              </div>
            </div>
          </div>

          <div class="project-details-card" id="projectDetailsCard">
            <div class="project-details-header">
              <div>
                <p class="eyebrow" style="color: #475569">Project Details</p>
                <h3 style="margin-top: 2px">
                  Describe where and who you're working for
                </h3>
              </div>
              <div class="project-details-actions view-toggle">
                <button id="editProjectDetailsButton" class="secondary">
                  Edit Details
                </button>
              </div>
            </div>
            <form class="project-details-form" id="projectDetailsForm">
              <div class="project-details-grid">
                <div>
                  <label for="projectDetailName">Project Name</label>
                  <input
                    type="text"
                    id="projectDetailName"
                    placeholder="Subdivision 2024"
                  />
                </div>
                <div>
                  <label for="projectClientInput">Client</label>
                  <input
                    type="text"
                    id="projectClientInput"
                    placeholder="City of Exampleville"
                  />
                </div>
                <div>
                  <label for="projectClientPhoneInput">Client Phone</label>
                  <input
                    type="tel"
                    id="projectClientPhoneInput"
                    placeholder="(555) 123-4567"
                  />
                </div>
                <div>
                  <label for="projectClientEmailInput">Client Email</label>
                  <input
                    type="email"
                    id="projectClientEmailInput"
                    placeholder="client@example.com"
                  />
                </div>
                <div class="full-row">
                  <label for="projectAddressInput">Address</label>
                  <textarea
                    id="projectAddressInput"
                    rows="2"
                    placeholder="123 Main St, Exampleville, WA"
                  ></textarea>
                </div>
                <div>
                  <label for="projectTownshipInput">Township(s)</label>
                  <input
                    type="text"
                    id="projectTownshipInput"
                    placeholder="T12N, T13N"
                  />
                  <small class="app-hint"
                    >Separate multiple entries with commas</small
                  >
                </div>
                <div>
                  <label for="projectRangeInput">Range(s)</label>
                  <input type="text" id="projectRangeInput" placeholder="R3W" />
                  <small class="app-hint"
                    >Separate multiple entries with commas</small
                  >
                </div>
                <div>
                  <label for="projectSectionInput">Section(s)</label>
                  <input
                    type="text"
                    id="projectSectionInput"
                    placeholder="12, 13"
                  />
                  <small class="app-hint"
                    >Separate multiple entries with commas</small
                  >
                </div>
                <div class="full-row">
                  <label for="projectDescriptionInput">Description</label>
                  <textarea
                    id="projectDescriptionInput"
                    rows="3"
                    placeholder="Notes about scope, nearby landmarks, or routing instructions"
                  ></textarea>
                </div>
              </div>
              <div class="project-details-actions">
                <button type="submit" id="saveProjectDetailsButton">
                  Save Project Details
                </button>
              </div>
            </form>
          </div>

          <h2>Project Apps</h2>
          <p class="subtitle" style="margin-top: 0">
            Select a mini app to work with your current project.
          </p>
          <div class="springboard-grid">
            <button class="app-tile" data-target="traverseSection">
              <span class="app-icon">üß≠</span>
              <span class="app-title">Traversals</span>
              <span class="app-hint">Build traverse paths and commands</span>
            </button>
            <button class="app-tile" data-target="pointsSection">
              <span class="app-icon">üìç</span>
              <span class="app-title">Point Files</span>
              <span class="app-hint"
                >Manage survey control and stakeout points</span
              >
            </button>
            <button class="app-tile" data-target="evidenceSection">
              <span class="app-icon">üßæ</span>
              <span class="app-title">Evidence Records</span>
              <span class="app-hint">Document monuments and attach photos</span>
            </button>
            <button class="app-tile" data-target="equipmentSection">
              <span class="app-icon">üì°</span>
              <span class="app-title">Equipment Setup</span>
              <span class="app-hint">Log base locations and crews</span>
            </button>
            <button class="app-tile" data-target="navigationSection">
              <span class="app-icon">üõ∞Ô∏è</span>
              <span class="app-title">Navigation</span>
              <span class="app-hint">Field navigation tools and routes</span>
            </button>
            <button class="app-tile" data-target="settingsSection">
              <span class="app-icon">‚öôÔ∏è</span>
              <span class="app-title">Global Settings</span>
              <span class="app-hint"
                >Manage equipment, crews, codes &amp; backups</span
              >
            </button>
          </div>
        </div>

        <div id="traverseSection" class="tool-section">
          <h3>Project Overview</h3>
          <canvas id="projectOverviewCanvas"></canvas>

          <hr />

          <h2>Records of Survey</h2>
          <div
            style="
              display: flex;
              gap: 10px;
              margin-bottom: 15px;
              flex-wrap: wrap;
            "
          >
            <input
              type="text"
              id="recordNameInput"
              placeholder="Record Name (e.g., Tract 1234)"
            />
            <button id="createRecordButton">+ New Record</button>
          </div>

          <div class="record-list" id="recordList"></div>

          <div id="editor" style="display: none">
            <h2 id="currentRecordName">Record Name</h2>
            <button class="danger" style="float: right" id="deleteRecordButton">
              Delete Record
            </button>

            <h3>Starting Point Setup</h3>
            <div class="form-grid">
              <div>
                <label>Starting Point Number &amp; Link</label>
                <div class="start-point-row">
                  <input type="number" id="startPtNum" placeholder="1" />
                  <div
                    id="startFromDropdownContainer"
                    class="start-dropdown-container"
                  >
                    <button
                      type="button"
                      id="startFromDropdownToggle"
                      class="start-dropdown-toggle"
                    >
                      <span class="label" id="startFromDropdownLabel"
                        >Manual Start</span
                      >
                      <span class="arrow">‚ñº</span>
                    </button>
                    <div
                      id="startFromDropdownMenu"
                      class="start-dropdown-menu"
                    ></div>
                  </div>
                </div>

                <label>Northing (Y)</label>
                <input type="number" id="northing" placeholder="5000" />
              </div>
              <div>
                <label>Easting (X)</label>
                <input type="number" id="easting" placeholder="5000" />
                <label>Elevation (Z)</label>
                <input type="number" id="elevation" placeholder="0" />
              </div>
            </div>
            <label>Backsight Azimuth (dd.mmss)</label>
            <input type="number" id="bsAzimuth" placeholder="0.0000" />

            <h3>Basis and First Call</h3>
            <div class="form-grid">
              <div>
                <label>Basis of Bearing</label>
                <input type="text" id="basis" placeholder="N 45¬∞30'15&quot;E" />

                <label>First Distance (feet)</label>
                <input type="number" id="firstDist" placeholder="265.33" />
              </div>
              <div>
                <!-- Add button moved below table -->
              </div>
            </div>

            <table id="callsTable" class="calls-table">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Bearing</th>
                  <th colspan="2">Distance / Actions</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>

            <!-- Add button below list -->
            <div style="margin-top: 10px">
              <button id="addCallButton" class="success">
                + Add Subsequent Call
              </button>
            </div>

            <!-- ACTIVE RECORD CANVAS HERE -->
            <h3 style="margin-top: 20px">Traverse Preview</h3>
            <canvas id="traverseCanvas"></canvas>

            <button id="generateCommandsButton" style="margin-top: 20px">
              Generate Carlson Commands
            </button>

            <h3>Carlson Input Commands</h3>
            <div class="command-grid">
              <!-- Create Point -->
              <div class="command-card" data-group="createPoint">
                <div class="command-card-header">
                  <span>Create Point</span>
                  <button type="button">Copy</button>
                </div>
                <pre class="command-preview" id="preview-createPoint">
(empty)</pre
                >
                <textarea
                  class="command-full"
                  id="full-createPoint"
                  readonly
                ></textarea>
              </div>

              <!-- Occupy Point -->
              <div class="command-card" data-group="occupyPoint">
                <div class="command-card-header">
                  <span>Occupy Point</span>
                  <button type="button">Copy</button>
                </div>
                <pre class="command-preview" id="preview-occupyPoint">
(empty)</pre
                >
                <textarea
                  class="command-full"
                  id="full-occupyPoint"
                  readonly
                ></textarea>
              </div>

              <!-- Draw Points (Traverse) -->
              <div class="command-card" data-group="drawPoints">
                <div class="command-card-header">
                  <span>Draw Points</span>
                  <button type="button">Copy</button>
                </div>
                <pre class="command-preview" id="preview-drawPoints">
(empty)</pre
                >
                <textarea
                  class="command-full"
                  id="full-drawPoints"
                  readonly
                ></textarea>
              </div>

              <!-- Draw Lines -->
              <div class="command-card" data-group="drawLines">
                <div class="command-card-header">
                  <span>Draw Lines</span>
                  <button type="button">Copy</button>
                </div>
                <pre class="command-preview" id="preview-drawLines">
(empty)</pre
                >
                <textarea
                  class="command-full"
                  id="full-drawLines"
                  readonly
                ></textarea>
              </div>
            </div>
          </div>
        </div>

        <div id="pointsSection" class="tool-section">
          <div class="card">
            <h3>Point File Manager</h3>
            <p class="subtitle" style="margin-top: 0">
              Import CSV point coordinate files to store and edit points with
              your project. Columns should be: point number, x (or lat), y (or
              lon), elevation, code (and description if last column),
              description.
            </p>
            <div
              style="
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
                align-items: center;
              "
            >
              <button type="button" id="pointImportButton">
                Import Points CSV
              </button>
              <button type="button" id="addPointRowButton">
                Add Point Row
              </button>
              <button type="button" id="newPointFileButton">
                New Point File
              </button>
              <button type="button" id="renamePointFileButton">
                Rename Point File
              </button>
              <button type="button" id="downloadPointsButton" class="success">
                Download Points TXT
              </button>
              <label style="font-weight: 600; color: #1e40af">
                Active Point File
                <select
                  id="pointFileSelect"
                  style="margin-left: 8px; padding: 8px"
                >
                  <option>No point files</option>
                </select>
              </label>
              <label style="font-weight: 600; color: #0f172a">
                From Record
                <select
                  id="pointsFromRecordSelect"
                  style="margin-left: 8px; padding: 8px"
                >
                  <option>Select a project first</option>
                </select>
              </label>
              <button id="generatePointsFromTraverseButton" type="button">
                Generate Point File
              </button>
              <input
                type="file"
                id="pointsFileInput"
                accept=".csv,text/csv"
                style="display: none"
              />
            </div>

            <div class="table-scroll">
              <table id="pointsTable">
                <thead>
                  <tr>
                    <th>Point #</th>
                    <th>X / Lat</th>
                    <th>Y / Lon</th>
                    <th>Elevation</th>
                    <th>Code</th>
                    <th>Description</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="pointsTableBody">
                  <tr>
                    <td colspan="7">
                      Create or select a project to manage points.
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <div id="evidenceSection" class="tool-section">
          <div class="card">
            <h3>Evidence Capture</h3>
            <p class="subtitle" style="margin-top: 0">
              Link field notes and photos directly to traverse points generated
              from your records of survey.
            </p>

            <div class="form-grid">
              <div>
                <label for="evidenceRecordSelect">Record</label>
                <div
                  id="evidenceRecordDropdownContainer"
                  class="start-dropdown-container evidence-record-dropdown"
                >
                  <button
                    type="button"
                    id="evidenceRecordDropdownToggle"
                    class="start-dropdown-toggle"
                  >
                    <span class="label" id="evidenceRecordDropdownLabel"
                      >Select a record</span
                    >
                    <span class="arrow">‚ñº</span>
                  </button>
                  <div
                    id="evidenceRecordDropdownMenu"
                    class="start-dropdown-menu"
                  ></div>
                </div>
                <select
                  id="evidenceRecordSelect"
                  style="display: none"
                ></select>
              </div>
              <div>
                <label for="evidencePointSelect">Traverse Point</label>
                <select id="evidencePointSelect"></select>
              </div>
            </div>

            <div class="form-grid">
              <div>
                <label for="evidenceType">Evidence Type</label>
                <select id="evidenceType">
                  <option value="">Select‚Ä¶</option>
                  <option>Iron Rod</option>
                  <option>Rebar w/ Cap</option>
                  <option>Concrete Monument</option>
                  <option>Fence Corner</option>
                  <option>Tree Witness</option>
                  <option>Occupation Line Evidence</option>
                  <option>Structure / Wall</option>
                  <option>Other</option>
                </select>
              </div>
              <div>
                <label for="evidenceCondition">Condition / Status</label>
                <select id="evidenceCondition">
                  <option value="">Select‚Ä¶</option>
                  <option>Found in good condition</option>
                  <option>Found disturbed</option>
                  <option>Leaning / damaged</option>
                  <option>Buried</option>
                  <option>Destroyed / unreliable</option>
                  <option>Suspect / conflicting</option>
                </select>
              </div>
            </div>

            <label for="evidenceNotes">Notes / Field sketch</label>
            <textarea
              id="evidenceNotes"
              rows="3"
              placeholder="Describe monument, occupation, caps, witness ties, etc."
            ></textarea>

            <div class="form-grid">
              <div>
                <label for="evidenceTieDistance">Tie Distance</label>
                <input
                  id="evidenceTieDistance"
                  type="text"
                  placeholder="24.50 ft"
                />
              </div>
              <div>
                <label for="evidenceTieBearing">Tie Bearing</label>
                <input
                  id="evidenceTieBearing"
                  type="text"
                  placeholder="N35¬∞E"
                />
              </div>
            </div>

            <label for="evidenceTieDescription">Tie Description</label>
            <textarea
              id="evidenceTieDescription"
              rows="2"
              placeholder="Tree blaze, fence post, rebar, etc."
            ></textarea>

            <label for="evidenceTiePhotos">Tie Photos</label>
            <input
              id="evidenceTiePhotos"
              type="file"
              accept="image/*"
              multiple
            />
            <button type="button" id="addEvidenceTie">Add Tie</button>
            <p class="subtitle" id="evidenceTiesHint" style="margin: 6px 0 0 0">
              No ties added yet.
            </p>
            <ul id="evidenceTiesList" class="ties-list"></ul>

            <label for="evidencePhoto">Photo (optional)</label>
            <input id="evidencePhoto" type="file" accept="image/*" />

            <div
              style="
                display: flex;
                align-items: center;
                gap: 10px;
                flex-wrap: wrap;
              "
            >
              <button type="button" id="captureLocation">
                Get GPS Location
              </button>
              <span id="evidenceLocationStatus" class="subtitle"></span>
            </div>

            <div
              style="
                margin-top: 12px;
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
              "
            >
              <button type="button" class="success" id="saveEvidenceButton">
                Save Evidence
              </button>
              <button type="button" id="resetEvidenceButton">Reset Form</button>
            </div>
          </div>

          <div class="card">
            <h3>Project Evidence Points</h3>
            <p class="subtitle" id="evidenceSummary" style="margin-top: 0"></p>
            <div id="evidenceList"></div>
          </div>
        </div>

        <div id="equipmentSection" class="tool-section">
          <div class="card">
            <h3>Equipment Setup Log</h3>
            <p class="subtitle" style="margin-top: 0">
              Track base station setup and teardown information for this
              project.
            </p>

            <div class="form-grid">
              <div>
                <label for="equipmentSetupAt">Setup Date &amp; Time</label>
                <input id="equipmentSetupAt" type="datetime-local" />
              </div>
              <div>
                <label for="equipmentTearDownAt"
                  >Tear Down Date &amp; Time</label
                >
                <input id="equipmentTearDownAt" type="datetime-local" />
              </div>
            </div>

            <div class="form-grid">
              <div>
                <label for="equipmentBaseHeight">Base Station Height</label>
                <input
                  id="equipmentBaseHeight"
                  type="text"
                  placeholder="e.g., 1.500 m"
                />
              </div>
              <div>
                <label for="equipmentReferencePoint">Reference Point</label>
                <select id="equipmentReferencePointPicker"></select>
                <input
                  id="equipmentReferencePoint"
                  type="text"
                  placeholder="Control point or benchmark used"
                  list="equipmentReferencePointOptions"
                />
                <datalist id="equipmentReferencePointOptions"></datalist>
              </div>
            </div>

            <div class="form-grid">
              <div>
                <label for="equipmentSetupBy">Set Up By</label>
                <input
                  id="equipmentSetupBy"
                  type="text"
                  placeholder="Crew or person responsible"
                />
              </div>
              <div>
                <label for="captureEquipmentLocation">GPS Location</label>
                <div style="display: flex; gap: 10px; align-items: center">
                  <button type="button" id="captureEquipmentLocation">
                    Get GPS Location
                  </button>
                  <span id="equipmentLocationStatus" class="subtitle"></span>
                </div>
              </div>
            </div>

            <label for="equipmentWorkNotes">Work / Daily Goal</label>
            <textarea
              id="equipmentWorkNotes"
              placeholder="Describe today's objectives or tasks to pair with this setup"
            ></textarea>

            <div id="equipmentFormStatus" class="equipment-form-status"></div>

            <div
              style="
                margin-top: 12px;
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
              "
            >
              <button type="button" class="success" id="saveEquipmentButton">
                Save Equipment Entry
              </button>
              <button type="button" id="resetEquipmentButton">
                Reset Form
              </button>
            </div>
          </div>

          <div class="card">
            <h3>Equipment Records</h3>
            <p class="subtitle" id="equipmentSummary" style="margin-top: 0"></p>
            <div id="equipmentList"></div>
          </div>
        </div>

        <div id="navigationSection" class="tool-section">
          <div class="card">
            <h3>Navigation</h3>
            <p class="subtitle" style="margin-top: 0">
              Draw a compass, follow headings, and return to important project
              locations. Capture stakeout targets, travel headings, and
              equipment bases so you can walk the correct line in the field.
            </p>

            <div class="navigation-grid">
              <div class="navigation-panel compass-wrapper">
                <canvas
                  id="navigationCompass"
                  width="320"
                  height="320"
                ></canvas>
                <div class="compass-readouts">
                  <div class="stat-chip">
                    <div class="stat-label">Heading Source</div>
                    <div class="stat-value" id="navigationHeadingValue">--</div>
                  </div>
                  <div class="stat-chip">
                    <div class="stat-label">Target Bearing</div>
                    <div class="stat-value" id="navigationTargetBearing">
                      --
                    </div>
                  </div>
                  <div class="stat-chip">
                    <div class="stat-label">Distance to Target</div>
                    <div class="stat-value" id="navigationTargetDistance">
                      --
                    </div>
                  </div>
                  <div class="stat-chip">
                    <div class="stat-label">Line Offset</div>
                    <div class="stat-value" id="navigationOffset">--</div>
                  </div>
                </div>
                <div
                  class="subtitle"
                  id="navigationStatus"
                  style="margin: 0"
                ></div>
              </div>

              <div
                class="navigation-panel navigation-map hidden"
                id="navigationMapPanel"
              >
                <h4 style="margin-top: 0">Map Preview</h4>
                <iframe
                  id="navigationMapFrame"
                  title="Navigation Map"
                  loading="lazy"
                  referrerpolicy="no-referrer-when-downgrade"
                ></iframe>
                <div class="stat-chip">
                  <div class="stat-label">Map Status</div>
                  <div class="stat-value" id="navigationMapStatus">
                    Apply GPS localization to view the map.
                  </div>
                </div>
              </div>

              <div class="navigation-panel navigation-actions">
                <h4>Targets &amp; Saved Spots</h4>
                <div class="card" style="margin: 0 0 12px 0; padding: 12px">
                  <h4 style="margin: 0 0 8px 0">GPS Localization</h4>
                  <p
                    class="subtitle"
                    id="localizationSummary"
                    style="margin: 0 0 8px 0"
                  >
                    Choose a known point and enter its GPS coordinates to
                    convert local traverse and point file coordinates into
                    navigation targets.
                  </p>
                  <label for="localizationSource">Anchor Source</label>
                  <select id="localizationSource">
                    <option value="traverse">Traverse point</option>
                    <option value="pointFile">Point file</option>
                  </select>

                  <div id="localizationTraverseFields">
                    <label for="localizationRecord">Traverse record</label>
                    <select id="localizationRecord"></select>
                    <label for="localizationTraversePoint"
                      >Traverse point</label
                    >
                    <select id="localizationTraversePoint"></select>
                  </div>

                  <div id="localizationPointFileFields" style="display: none">
                    <label for="localizationPointFile">Point file</label>
                    <select id="localizationPointFile"></select>
                    <label for="localizationPointNumber">Point number</label>
                    <select id="localizationPointNumber"></select>
                  </div>

                  <div class="form-grid" style="margin-top: 12px">
                    <div>
                      <label for="localizationLat">Anchor Latitude</label>
                      <input
                        type="text"
                        id="localizationLat"
                        placeholder="e.g., 34.123456"
                      />
                    </div>
                    <div>
                      <label for="localizationLon">Anchor Longitude</label>
                      <input
                        type="text"
                        id="localizationLon"
                        placeholder="e.g., -117.123456"
                      />
                    </div>
                  </div>

                  <div
                    style="
                      display: flex;
                      gap: 8px;
                      flex-wrap: wrap;
                      margin-top: 10px;
                    "
                  >
                    <button
                      type="button"
                      class="success"
                      id="applyLocalization"
                    >
                      Apply GPS localization
                    </button>
                    <button
                      type="button"
                      class="secondary"
                      id="clearLocalization"
                    >
                      Clear localization
                    </button>
                  </div>
                  <div
                    class="subtitle"
                    id="localizationStatus"
                    style="margin-top: 6px"
                  ></div>
                </div>
                <label for="navigationBookmarkName"
                  >Name to save current position</label
                >
                <input
                  type="text"
                  id="navigationBookmarkName"
                  placeholder="E.g., Truck, Property corner, Cache"
                />
                <button id="saveNavigationBookmark">
                  Save current location
                </button>
                <div class="subtitle" id="navigationBookmarkStatus"></div>

                <label for="navigationTargetSelect">Navigate to</label>
                <select id="navigationTargetSelect"></select>

                <label for="navigationEquipmentSelect"
                  >Equipment setup (base)</label
                >
                <select id="navigationEquipmentSelect"></select>

                <div
                  style="
                    display: flex;
                    gap: 8px;
                    flex-wrap: wrap;
                    margin-top: 4px;
                  "
                >
                  <button class="secondary" id="refreshNavigation">
                    Refresh sources
                  </button>
                  <button id="clearNavigationTarget" class="danger">
                    Clear target
                  </button>
                </div>

                <div class="bookmark-list" id="navigationBookmarksList"></div>
              </div>
            </div>
          </div>
        </div>

        <div id="settingsSection" class="tool-section">
          <div class="card">
            <h3>Global Settings</h3>
            <p class="subtitle" style="margin-top: 0">
              Configure reusable data shared across projects and keep a backup
              of everything stored in this app.
            </p>

            <div class="form-grid">
              <div>
                <label for="equipmentNameInput">Equipment Names</label>
                <div class="input-row">
                  <input
                    type="text"
                    id="equipmentNameInput"
                    placeholder="Base 1, Rover, Receiver"
                  />
                  <button type="button" id="addEquipmentNameButton">Add</button>
                </div>
                <ul id="equipmentNameList" class="pill-list"></ul>
              </div>
              <div>
                <label for="teamMemberInput">Team Members</label>
                <div class="input-row">
                  <input
                    type="text"
                    id="teamMemberInput"
                    placeholder="Crew Chief, Rodman"
                  />
                  <button type="button" id="addTeamMemberButton">Add</button>
                </div>
                <ul id="teamMemberList" class="pill-list"></ul>
              </div>
            </div>

            <div class="card" style="margin-top: 12px">
              <h4 style="margin-top: 0">Point Codes</h4>
              <div class="input-row">
                <input type="text" id="pointCodeInput" placeholder="Code" />
                <input
                  type="text"
                  id="pointCodeDescriptionInput"
                  placeholder="Description"
                />
                <button type="button" id="addPointCodeButton">Add</button>
              </div>
              <table class="calls-table">
                <thead>
                  <tr>
                    <th>Code</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody id="pointCodeTableBody"></tbody>
              </table>
            </div>

            <div class="card" style="margin-top: 12px">
              <h4 style="margin-top: 0">Backup &amp; Restore</h4>
              <p class="subtitle" style="margin-top: 0">
                Download a single file with all projects, evidence, and global
                settings or import one to restore.
              </p>
              <div style="display: flex; gap: 10px; flex-wrap: wrap">
                <button type="button" id="exportAllDataButton">
                  Download All App Data
                </button>
                <button type="button" id="importAllDataButton">
                  Import App Data
                </button>
              </div>
            </div>

            <p class="subtitle" style="margin-top: 12px">
              ¬© Michael Byrns. No liability is incurred by the use of this app
              or any data loss.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Hidden file input for import -->
    <input
      type="file"
      id="importFileInput"
      style="display: none"
      accept=".json,application/json"
    />
    <input
      type="file"
      id="importAllDataInput"
      style="display: none"
      accept=".json,application/json"
    />

    <div class="footer">
      All data saved locally in your browser ‚Ä¢ No server ‚Ä¢ Works offline
    </div>

    <script type="module" src="js/app.js"></script>
  </body>
</html>
